# stock-price-prediction
このレポジトリは、色々なモデルや色々な仮説に基づいて為替レートの予測をするためのものです。  

## direct_rate_prediction
[概要]  
N日目の始値、終値、高値、安値、取引量の5つを特徴量にN+1日目の終値のレートを予測する。  
[考察]  
一見予測ができているようにみえるが、拡大して表示してみると、結構外れてしまっている。（遅れて表示しているだけ。）  
次の日のレートをぴったり当てようとするモデルなので予測するのが難しいみたい。  
[次に向けて]  
もっと単純に「上昇 : 1」「下降 : 0」「そのまま : 0」として、3クラス分類をやってみる。  

## three_class_sequence
[概要]  
過去40日間の終値を特徴量に次の日の終値が上昇したか下降したかそのままかの3クラス分類  
[結果]  
テクニカル使わない  
Test accuracy 0.5040650412042244  
[使用技術]  
python  
keras  
MLP  
[考察]  
特徴量を特に工夫せずに行ったため、的中率50％に収束してしまい、完全にランダムで行ったのと同値の結果になってしまった。  
[次に向けて]  
テクニカル指標を特徴量に入れてみる。  

## three_class_sequence_with_tech  
[概要]  
過去40日間の終値を特徴量に次の日の終値が上昇したか下降したかそのままかの3クラス分類に特徴量を載せてみたモデル  
[結果]  
テクニカル使う  
Test accuracy 0.5040650412042244  
[使用技術]  
python  
keras  
MLP  
[考察]  
テクニカル指標を使った場合も変わらなかった。  
[次に向けて]  
もう少し方針を変えないとダメ。または、時系列データでよく使用されるlstmを使ってみる。  

## lstm_sequence  
[概要]  
日足で現在をT日としたとき、T-10日間を用いて、T+5日目を推測するモデル。  
「上昇:1, 下降:2, そのまま:0」の3クラス分類  
[結果]  
Test loss 0.6943061187966592  
Test accuracy 0.4815242494226328  
[使用技術]  
python  
keras  
LSTM  
[考察]
今までは、MLPでの学習だったので、時系列データをうまく扱えていなかったが、LSTMを使うことで時系列の前後関係の結びつきを保持することに成功した。  
dropoutを使うことで、accuracyに変化が出た  
[まとめ]  
まだ、50%前後を保ってしまっているので、ランダムとあまり変わらない状態になってしまっている。  
[次に向けて]  
・正規化をする  
・チャネルに特徴量を追加する  

## lstm_sequence_with_tech  
[概要]  
日足で現在をT日としたとき、T-10日間を用いて、T+5日目を推測するモデル。  
特徴量にボリンジャーバンドを追加した。  
「上昇:1, 下降:2, そのまま:0」の3クラス分類  
[結果]  
Test loss 0.6928190923622202  
Test accuracy 0.5208816703953488  
[使用技術]  
python  
keras  
LSTM  
[考察]
lstm_sequenceにボリンジャーバンド20期間の特徴量を追加した。  
すると、約4%の正答率が向上した。  
[まとめ]  
まだ、50%前後を保ってしまっているので、ランダムとあまり変わらない状態になってしまっている。  
[次に向けて]  
・他の特徴量を追加する  

## lstm_sequence_with_tech_ver2  
[概要]  
日足で現在をT日としたとき、T-10日間を用いて、T+5日目を推測するモデル。  
特徴量に指数平滑移動平均線を追加した。  
「上昇:1, 下降:2, そのまま:0」の3クラス分類  
[結果]  
Test loss 0.6932130108853227  
Test accuracy 0.5208816703953488  
[使用技術]  
python  
keras  
LSTM  
[特徴量]  
過去10日間のデータ  
過去10日間の20期間ボリンジャーバンド  
過去10日間の13,21期間の指数平滑移動平均線  
[考察]  
lstm_sequence_with_techに指数平滑移動平均線13,21期間の特徴量を追加した。   
結果は変わらなかった。
[まとめ]  
lstm_sequence_with_techと変わらない結果になった。特徴量を増やす方針から変えないといけないかもしれない。　　
まだ、50%前後を保ってしまっているので、ランダムとあまり変わらない状態になってしまっている。  
[次に向けて]  
・違うクラス分類を考える  